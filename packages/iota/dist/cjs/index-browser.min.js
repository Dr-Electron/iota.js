!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@iota/crypto.js"),require("big-integer"),require("@iota/util.js")):"function"==typeof define&&define.amd?define(["exports","@iota/crypto.js","big-integer","@iota/util.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Iota={},e.IotaCrypto,e.bigInt,e.IotaUtil)}(this,(function(e,t,n,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=r(n);class a{constructor(e){this._publicKey=e}toAddress(){return t.Blake2b.sum256(this._publicKey)}verify(e){return t.ArrayHelper.equal(this.toAddress(),e)}}a.ADDRESS_LENGTH=t.Blake2b.SIZE_256;const o=16,d=t.Blake2b.SIZE_256,u=t.Blake2b.SIZE_256,l=t.Blake2b.SIZE_256;function c(e){if(!e.hasRemaining(21))throw new Error(`Alias address data is ${e.length()} in length which is less than the minimimum size required of 21`);const t=e.readByte("aliasAddress.type");if(8!==t)throw new Error(`Type mismatch in aliasAddress ${t}`);return{type:8,address:e.readFixedHex("aliasAddress.address",20)}}function p(e,t){e.writeByte("aliasAddress.type",t.type),e.writeFixedHex("aliasAddress.address",20,t.address)}function h(e){if(!e.hasRemaining(33))throw new Error(`BLS address data is ${e.length()} in length which is less than the minimimum size required of 33`);const t=e.readByte("blsAddress.type");if(1!==t)throw new Error(`Type mismatch in blsAddress ${t}`);return{type:1,address:e.readFixedHex("blsAddress.address",32)}}function m(e,t){e.writeByte("blsAddress.type",t.type),e.writeFixedHex("blsAddress.address",32,t.address)}const f=1+a.ADDRESS_LENGTH;function y(e){if(!e.hasRemaining(f))throw new Error(`Ed25519 address data is ${e.length()} in length which is less than the minimimum size required of ${f}`);const t=e.readByte("ed25519Address.type");if(0!==t)throw new Error(`Type mismatch in ed25519Address ${t}`);return{type:0,address:e.readFixedHex("ed25519Address.address",a.ADDRESS_LENGTH)}}function g(e,t){e.writeByte("ed25519Address.type",t.type),e.writeFixedHex("ed25519Address.address",a.ADDRESS_LENGTH,t.address)}function w(e){if(!e.hasRemaining(21))throw new Error(`NFT address data is ${e.length()} in length which is less than the minimimum size required of 21`);const t=e.readByte("nftAddress.type");if(t!==o)throw new Error(`Type mismatch in nftAddress ${t}`);const n=e.readFixedHex("nftAddress.address",20);return{type:o,address:n}}function T(e,t){e.writeByte("nftAddress.type",t.type),e.writeFixedHex("nftAddress.address",20,t.address)}const I=Math.min(f,21,33,21);function E(e){if(!e.hasRemaining(I))throw new Error(`Address data is ${e.length()} in length which is less than the minimimum size required of ${I}`);const t=e.readByte("address.type",!1);let n;if(0===t)n=y(e);else if(8===t)n=c(e);else if(1===t)n=h(e);else{if(t!==o)throw new Error(`Unrecognized address type ${t}`);n=w(e)}return n}function _(e,t){if(0===t.type)g(e,t);else if(8===t.type)p(e,t);else if(1===t.type)m(e,t);else{if(t.type!==o)throw new Error(`Unrecognized address type ${t.type}`);T(e,t)}}function x(e){if(!e.hasRemaining(5))throw new Error(`ExpirationMilestoneIndex Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("expirationMilestoneIndexFeatureBlock.type");if(5!==t)throw new Error(`Type mismatch in expirationMilestoneIndexFeatureBlock ${t}`);return{type:5,milestoneIndex:e.readUInt32("expirationMilestoneIndexFeatureBlock.milestoneIndex")}}function U(e,t){e.writeByte("expirationMilestoneIndexFeatureBlock.type",t.type),e.writeUInt32("expirationMilestoneIndexFeatureBlock.milestoneIndex",t.milestoneIndex)}function $(e){if(!e.hasRemaining(5))throw new Error(`ExpirationUnix Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("expirationUnixFeatureBlock.type");if(6!==t)throw new Error(`Type mismatch in expirationUnixFeatureBlock ${t}`);return{type:6,unixTime:e.readUInt32("expirationUnixFeatureBlock.unixTime")}}function k(e,t){e.writeByte("expirationUnixFeatureBlock.type",t.type),e.writeUInt32("expirationUnixFeatureBlock.unixTime",t.unixTime)}function B(e){if(!e.hasRemaining(5))throw new Error(`Indexation Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("indexationFeatureBlock.type");if(8!==t)throw new Error(`Type mismatch in indexationFeatureBlock ${t}`);const n=e.readUInt32("indexationFeatureBlock.tagLength");return{type:8,tag:e.readFixedHex("indexationFeatureBlock.tag",n)}}function S(e,t){e.writeByte("indexationFeatureBlock.type",t.type),e.writeUInt32("indexationFeatureBlock.tagLength",t.tag.length/2),e.writeFixedHex("indexationFeatureBlock.tag",t.tag.length/2,t.tag)}const N=1+I;function A(e){if(!e.hasRemaining(N))throw new Error(`Issuer Feature Block data is ${e.length()} in length which is less than the minimimum size required of ${N}`);const t=e.readByte("issuerFeatureBlock.type");if(1!==t)throw new Error(`Type mismatch in issuerFeatureBlock ${t}`);return{type:1,address:E(e)}}function M(e,t){e.writeByte("issuerFeatureBlock.type",t.type),_(e,t.address)}function O(e){if(!e.hasRemaining(5))throw new Error(`Metadata Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("metadataFeatureBlock.type");if(7!==t)throw new Error(`Type mismatch in metadataFeatureBlock ${t}`);const n=e.readUInt32("metadataFeatureBlock.dataLength");return{type:7,data:e.readFixedHex("metadataFeatureBlock.data",n)}}function P(e,t){e.writeByte("metadataFeatureBlock.type",t.type),e.writeUInt32("metadataFeatureBlock.dataLength",t.data.length/2),e.writeFixedHex("metadataFeatureBlock.data",t.data.length/2,t.data)}function F(e){if(!e.hasRemaining(9))throw new Error(`Return Feature Block data is ${e.length()} in length which is less than the minimimum size required of 9`);const t=e.readByte("returnFeatureBlock.type");if(2!==t)throw new Error(`Type mismatch in returnFeatureBlock ${t}`);const n=e.readUInt64("returnFeatureBlock.amount");return{type:2,amount:Number(n)}}function R(e,t){e.writeByte("returnFeatureBlock.type",t.type),e.writeUInt64("returnFeatureBlock.amount",s.default(t.amount))}const L=1+I;function v(e){if(!e.hasRemaining(L))throw new Error(`Sender Feature Block data is ${e.length()} in length which is less than the minimimum size required of ${L}`);const t=e.readByte("senderFeatureBlock.type");if(0!==t)throw new Error(`Type mismatch in senderFeatureBlock ${t}`);return{type:0,address:E(e)}}function H(e,t){e.writeByte("senderFeatureBlock.type",t.type),_(e,t.address)}function z(e){if(!e.hasRemaining(5))throw new Error(`TimelockMilestoneIndex Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("timelockMilestoneIndexFeatureBlock.type");if(3!==t)throw new Error(`Type mismatch in timelockMilestoneIndexFeatureBlock ${t}`);return{type:3,milestoneIndex:e.readUInt32("timelockMilestoneIndexFeatureBlock.milestoneIndex")}}function b(e,t){e.writeByte("timelockMilestoneIndexFeatureBlock.type",t.type),e.writeUInt32("timelockMilestoneIndexFeatureBlock.milestoneIndex",t.milestoneIndex)}function C(e){if(!e.hasRemaining(5))throw new Error(`TimelockUnix Feature Block data is ${e.length()} in length which is less than the minimimum size required of 5`);const t=e.readByte("timelockUnixFeatureBlock.type");if(4!==t)throw new Error(`Type mismatch in timelockUnixFeatureBlock ${t}`);return{type:4,unixTime:e.readUInt32("timelockUnixFeatureBlock.unixTime")}}function D(e,t){e.writeByte("timelockUnixFeatureBlock.type",t.type),e.writeUInt32("timelockUnixFeatureBlock.unixTime",t.unixTime)}const K=Math.min(L,N,9,5,5,5,5,5,5);function G(e){const t=e.readUInt16("featureBlocks.numFeatureBlocks"),n=[];for(let i=0;i<t;i++)n.push(q(e));return n}function Y(e,t){e.writeUInt16("featureBlocks.numFeatureBlocks",t.length);for(let n=0;n<t.length;n++)X(e,t[n])}function q(e){if(!e.hasRemaining(K))throw new Error(`Feature block data is ${e.length()} in length which is less than the minimimum size required of ${K}`);const t=e.readByte("featureBlock.type",!1);let n;if(0===t)n=v(e);else if(1===t)n=A(e);else if(2===t)n=F(e);else if(3===t)n=z(e);else if(4===t)n=C(e);else if(5===t)n=x(e);else if(6===t)n=$(e);else if(7===t)n=O(e);else{if(8!==t)throw new Error(`Unrecognized feature block type ${t}`);n=B(e)}return n}function X(e,t){if(0===t.type)H(e,t);else if(1===t.type)M(e,t);else if(2===t.type)R(e,t);else if(3===t.type)b(e,t);else if(4===t.type)D(e,t);else if(5===t.type)U(e,t);else if(6===t.type)k(e,t);else if(7===t.type)P(e,t);else{if(8!==t.type)throw new Error(`Unrecognized feature block type ${t.type}`);S(e,t)}}const W=49+I+8;function Z(e){const t=e.readUInt16("funds.numFunds"),n=[];for(let i=0;i<t;i++)n.push(j(e));return n}function J(e,t){if(t.length>127)throw new Error(`The maximum number of funds is 127, you have provided ${t.length}`);e.writeUInt16("funds.numFunds",t.length);for(let n=0;n<t.length;n++)V(e,t[n])}function j(e){if(!e.hasRemaining(W))throw new Error(`Migrated funds data is ${e.length()} in length which is less than the minimimum size required of ${W}`);const t=e.readFixedHex("migratedFunds.tailTransactionHash",49),n=E(e),i=e.readUInt64("migratedFunds.deposit");return{tailTransactionHash:t,address:n,deposit:Number(i)}}function V(e,t){e.writeFixedHex("migratedFunds.tailTransactionHash",49,t.tailTransactionHash),_(e,t.address),e.writeUInt64("migratedFunds.deposit",s.default(t.deposit))}const Q=1+u;function ee(e){if(!e.hasRemaining(Q))throw new Error(`Treasury Input data is ${e.length()} in length which is less than the minimimum size required of ${Q}`);const t=e.readByte("treasuryInput.type");if(1!==t)throw new Error(`Type mismatch in treasuryInput ${t}`);return{type:1,milestoneId:e.readFixedHex("treasuryInput.milestoneId",u)}}function te(e,t){e.writeByte("treasuryInput.type",t.type),e.writeFixedHex("treasuryInput.milestoneId",u,t.milestoneId)}const ne=1+u+2;function ie(e){if(!e.hasRemaining(ne))throw new Error(`UTXO Input data is ${e.length()} in length which is less than the minimimum size required of ${ne}`);const t=e.readByte("utxoInput.type");if(0!==t)throw new Error(`Type mismatch in utxoInput ${t}`);return{type:0,transactionId:e.readFixedHex("utxoInput.transactionId",u),transactionOutputIndex:e.readUInt16("utxoInput.transactionOutputIndex")}}function re(e,t){e.writeByte("utxoInput.type",t.type),e.writeFixedHex("utxoInput.transactionId",u,t.transactionId),e.writeUInt16("utxoInput.transactionOutputIndex",t.transactionOutputIndex)}const se=Math.min(ne,Q);function ae(e){const t=e.readUInt16("inputs.numInputs"),n=[];for(let i=0;i<t;i++)n.push(de(e));return n}function oe(e,t){if(t.length<1)throw new Error(`The minimum number of inputs is 1, you have provided ${t.length}`);if(t.length>127)throw new Error(`The maximum number of inputs is 127, you have provided ${t.length}`);e.writeUInt16("inputs.numInputs",t.length);for(let n=0;n<t.length;n++)ue(e,t[n])}function de(e){if(!e.hasRemaining(se))throw new Error(`Input data is ${e.length()} in length which is less than the minimimum size required of ${se}`);const t=e.readByte("input.type",!1);let n;if(0===t)n=ie(e);else{if(1!==t)throw new Error(`Unrecognized input type ${t}`);n=ee(e)}return n}function ue(e,t){if(0===t.type)re(e,t);else{if(1!==t.type)throw new Error(`Unrecognized input type ${t.type}`);te(e,t)}}const le=64;const ce=16+d+d+l+8+1+t.Ed25519.PUBLIC_KEY_SIZE+1+t.Ed25519.SIGNATURE_SIZE;const pe=10+W;function he(e){const t=e.readUInt16("nativeTokens.numNativeTokens"),n=[];for(let i=0;i<t;i++)n.push(fe(e));return n}function me(e,t){e.writeUInt16("nativeTokens.numNativeTokens",t.length);for(let n=0;n<t.length;n++)ye(e,t[n])}function fe(e){return{id:e.readFixedHex("nativeToken.id",38),amount:e.readUInt256("nativeToken.amount").toString()}}function ye(e,t){e.writeFixedHex("nativeToken.id",38,t.id),e.writeUInt256("nativeToken.amount",s.default(t.amount))}const ge=31+I+I+4+4+4+2;function we(e){if(!e.hasRemaining(ge))throw new Error(`Alias Output data is ${e.length()} in length which is less than the minimimum size required of ${ge}`);const t=e.readByte("aliasOutput.type");if(4!==t)throw new Error(`Type mismatch in aliasOutput ${t}`);const n=e.readUInt64("aliasOutput.amount"),i=he(e),r=e.readFixedHex("aliasOutput.aliasId",20),s=E(e),a=E(e),o=e.readUInt32("aliasOutput.stateIndex"),d=e.readUInt32("aliasOutput.stateMetadataLength"),u=e.readFixedHex("aliasOutput.stateMetadata",d),l=e.readUInt32("aliasOutput.foundryCounter"),c=G(e);return{type:4,amount:Number(n),nativeTokens:i,aliasId:r,stateController:s,governanceController:a,stateIndex:o,stateMetadata:u,foundryCounter:l,blocks:c}}function Te(e,t){e.writeByte("aliasOutput.type",t.type),e.writeUInt64("aliasOutput.amount",s.default(t.amount)),me(e,t.nativeTokens),e.writeFixedHex("aliasOutput.aliasId",20,t.aliasId),_(e,t.stateController),_(e,t.governanceController),e.writeUInt32("aliasOutput.stateIndex",t.stateIndex),e.writeUInt32("aliasOutput.stateMetadataLength",t.stateMetadata.length/2),e.writeFixedHex("aliasOutput.stateMetadata",t.stateMetadata.length/2,t.stateMetadata),e.writeUInt32("aliasOutput.foundryCounter",t.foundryCounter),Y(e,t.blocks)}const Ie=11+I+2;function Ee(e){if(!e.hasRemaining(Ie))throw new Error(`Extended Output data is ${e.length()} in length which is less than the minimimum size required of ${Ie}`);const t=e.readByte("extendedOutput.type");if(3!==t)throw new Error(`Type mismatch in extendedOutput ${t}`);const n=e.readUInt64("extendedOutput.amount"),i=he(e),r=E(e),s=G(e);return{type:3,amount:Number(n),address:r,nativeTokens:i,blocks:s}}function _e(e,t){e.writeByte("extendedOutput.type",t.type),e.writeUInt64("extendedOutput.amount",s.default(t.amount)),me(e,t.nativeTokens),_(e,t.address),Y(e,t.blocks)}function xe(e){if(!e.hasRemaining(1))throw new Error(`Simple Token Scheme data is ${e.length()} in length which is less than the minimimum size required of 1`);const t=e.readByte("simpleTokenScheme.type");if(0!==t)throw new Error(`Type mismatch in simpleTokenScheme ${t}`);return{type:0}}function Ue(e,t){e.writeByte("simpleTokenScheme.type",t.type)}function $e(e){if(!e.hasRemaining(1))throw new Error(`Token Scheme data is ${e.length()} in length which is less than the minimimum size required of 1`);const t=e.readByte("tokenScheme.type",!1);let n;if(0!==t)throw new Error(`Unrecognized token scheme type ${t}`);return n=xe(e),n}function ke(e,t){if(0!==t.type)throw new Error(`Unrecognized simple token scheme type ${t.type}`);Ue(e,t)}const Be=11+I+4+12+32+32+1+2;function Se(e){if(!e.hasRemaining(Be))throw new Error(`Foundry Output data is ${e.length()} in length which is less than the minimimum size required of ${Be}`);const t=e.readByte("foundryOutput.type");if(5!==t)throw new Error(`Type mismatch in foundryOutput ${t}`);const n=e.readUInt64("foundryOutput.amount"),i=he(e),r=E(e),s=e.readUInt32("foundryOutput.serialNumber"),a=e.readFixedHex("foundryOutput.tokenTag",12),o=e.readUInt256("foundryOutput.circulatingSupply"),d=e.readUInt256("foundryOutput.maximumSupply"),u=$e(e),l=G(e);return{type:5,amount:Number(n),nativeTokens:i,address:r,serialNumber:s,tokenTag:a,circulatingSupply:o.toString(),maximumSupply:d.toString(),tokenScheme:u,blocks:l}}function Ne(e,t){e.writeByte("foundryOutput.type",t.type),e.writeUInt64("foundryOutput.amount",s.default(t.amount)),me(e,t.nativeTokens),_(e,t.address),e.writeUInt32("foundryOutput.serialNumber",t.serialNumber),e.writeFixedHex("foundryOutput.tokenTag",12,t.tokenTag),e.writeUInt256("foundryOutput.circulatingSupply",s.default(t.circulatingSupply)),e.writeUInt256("foundryOutput.maximumSupply",s.default(t.maximumSupply)),ke(e,t.tokenScheme),Y(e,t.blocks)}const Ae=11+I+20+4+2;function Me(e){if(!e.hasRemaining(Ae))throw new Error(`NFT Output data is ${e.length()} in length which is less than the minimimum size required of ${Ae}`);const t=e.readByte("nftOutput.type");if(6!==t)throw new Error(`Type mismatch in nftOutput ${t}`);const n=e.readUInt64("nftOutput.amount"),i=he(e),r=E(e),s=e.readFixedHex("nftOutput.nftId",20),a=e.readUInt32("nftOutput.immutableMetadataLength"),o=e.readFixedHex("nftOutput.immutableMetadata",a),d=G(e);return{type:6,amount:Number(n),nativeTokens:i,address:r,nftId:s,immutableData:o,blocks:d}}function Oe(e,t){e.writeByte("nftOutput.type",t.type),e.writeUInt64("nftOutput.amount",s.default(t.amount)),me(e,t.nativeTokens),_(e,t.address),e.writeFixedHex("nftOutput.nftId",20,t.nftId),e.writeUInt32("nftOutput.immutableMetadataLength",t.immutableData.length/2),e.writeFixedHex("nftOutput.immutableMetadata",t.immutableData.length/2,t.immutableData),Y(e,t.blocks)}const Pe=1+I+8;function Fe(e){if(!e.hasRemaining(Pe))throw new Error(`Signature Locked Dust Allowance Output data is ${e.length()} in length which is less than the minimimum size required of ${Pe}`);const t=e.readByte("sigLockedDustAllowanceOutput.type");if(1!==t)throw new Error(`Type mismatch in sigLockedDustAllowanceOutput ${t}`);const n=E(e),i=e.readUInt64("sigLockedDustAllowanceOutput.amount");return{type:1,address:n,amount:Number(i)}}function Re(e,t){e.writeByte("sigLockedDustAllowanceOutput.type",t.type),_(e,t.address),e.writeUInt64("sigLockedDustAllowanceOutput.amount",s.default(t.amount))}const Le=1+I+8;function ve(e){if(!e.hasRemaining(Le))throw new Error(`Simple Output data is ${e.length()} in length which is less than the minimimum size required of ${Le}`);const t=e.readByte("simpleOutput.type");if(0!==t)throw new Error(`Type mismatch in simpleOutput ${t}`);const n=E(e),i=e.readUInt64("simpleOutput.amount");return{type:0,address:n,amount:Number(i)}}function He(e,t){e.writeByte("simpleOutput.type",t.type),_(e,t.address),e.writeUInt64("simpleOutput.amount",s.default(t.amount))}function ze(e){if(!e.hasRemaining(9))throw new Error(`Treasury Output data is ${e.length()} in length which is less than the minimimum size required of 9`);const t=e.readByte("treasuryOutput.type");if(2!==t)throw new Error(`Type mismatch in treasuryOutput ${t}`);const n=e.readUInt64("treasuryOutput.amount");return{type:2,amount:Number(n)}}function be(e,t){e.writeByte("treasuryOutput.type",t.type),e.writeUInt64("treasuryOutput.amount",s.default(t.amount))}const Ce=Math.min(Le,Pe,9,Be,Ie,Ae,ge);function De(e){const t=e.readUInt16("outputs.numOutputs"),n=[];for(let i=0;i<t;i++)n.push(Ge(e));return n}function Ke(e,t){if(t.length<1)throw new Error(`The minimum number of outputs is 1, you have provided ${t.length}`);if(t.length>127)throw new Error(`The maximum number of outputs is 127, you have provided ${t.length}`);e.writeUInt16("outputs.numOutputs",t.length);for(let n=0;n<t.length;n++)Ye(e,t[n])}function Ge(e){if(!e.hasRemaining(Ce))throw new Error(`Output data is ${e.length()} in length which is less than the minimimum size required of ${Ce}`);const t=e.readByte("output.type",!1);let n;if(0===t)n=ve(e);else if(1===t)n=Fe(e);else if(2===t)n=ze(e);else if(3===t)n=Ee(e);else if(5===t)n=Se(e);else if(6===t)n=Me(e);else{if(4!==t)throw new Error(`Unrecognized output type ${t}`);n=we(e)}return n}function Ye(e,t){if(0===t.type)He(e,t);else if(1===t.type)Re(e,t);else if(2===t.type)be(e,t);else if(3===t.type)_e(e,t);else if(5===t.type)Ne(e,t);else if(6===t.type)Oe(e,t);else{if(4!==t.type)throw new Error(`Unrecognized output type ${t.type}`);Te(e,t)}}function qe(e){if(!e.hasRemaining(9))throw new Error(`Transaction essence data is ${e.length()} in length which is less than the minimimum size required of 9`);const t=e.readByte("transactionEssence.type");if(0!==t)throw new Error(`Type mismatch in transactionEssence ${t}`);const n=ae(e),i=De(e),r=pt(e);if(r&&2!==r.type)throw new Error("Transaction essence can only contain embedded Indexation Payload");for(const e of n)if(0!==e.type)throw new Error("Transaction essence can only contain UTXO Inputs");for(const e of i)if(0!==e.type)throw new Error("Transaction essence can only contain simple outputs");return{type:0,inputs:n,outputs:i,payload:r}}function Xe(e,t){e.writeByte("transactionEssence.type",t.type);for(const e of t.inputs)if(0!==e.type)throw new Error("Transaction essence can only contain UTXO Inputs");oe(e,t.inputs);for(const e of t.outputs)if(0!==e.type&&1!==e.type)throw new Error("Transaction essence can only contain sig locked single input or sig locked dust allowance outputs");Ke(e,t.outputs),ht(e,t.payload)}function We(e){if(!e.hasRemaining(3))throw new Error(`Reference Unlock Block data is ${e.length()} in length which is less than the minimimum size required of 3`);const t=e.readByte("referenceUnlockBlock.type");if(1!==t)throw new Error(`Type mismatch in referenceUnlockBlock ${t}`);return{type:1,reference:e.readUInt16("referenceUnlockBlock.reference")}}function Ze(e,t){e.writeByte("referenceUnlockBlock.type",t.type),e.writeUInt16("referenceUnlockBlock.reference",t.reference)}const Je=1+t.Ed25519.SIGNATURE_SIZE+t.Ed25519.PUBLIC_KEY_SIZE;function je(e){if(!e.hasRemaining(Je))throw new Error(`Ed25519 signature data is ${e.length()} in length which is less than the minimimum size required of ${Je}`);const n=e.readByte("ed25519Signature.type");if(0!==n)throw new Error(`Type mismatch in ed25519Signature ${n}`);return{type:0,publicKey:e.readFixedHex("ed25519Signature.publicKey",t.Ed25519.PUBLIC_KEY_SIZE),signature:e.readFixedHex("ed25519Signature.signature",t.Ed25519.SIGNATURE_SIZE)}}function Ve(e,n){e.writeByte("ed25519Signature.type",n.type),e.writeFixedHex("ed25519Signature.publicKey",t.Ed25519.PUBLIC_KEY_SIZE,n.publicKey),e.writeFixedHex("ed25519Signature.signature",t.Ed25519.SIGNATURE_SIZE,n.signature)}const Qe=Je;function et(e){if(!e.hasRemaining(Qe))throw new Error(`Signature data is ${e.length()} in length which is less than the minimimum size required of ${Qe}`);const t=e.readByte("signature.type",!1);let n;if(0!==t)throw new Error(`Unrecognized signature type ${t}`);return n=je(e),n}function tt(e,t){if(0!==t.type)throw new Error(`Unrecognized signature type ${t.type}`);Ve(e,t)}const nt=1+Qe;function it(e){if(!e.hasRemaining(nt))throw new Error(`Signature Unlock Block data is ${e.length()} in length which is less than the minimimum size required of ${nt}`);const t=e.readByte("signatureUnlockBlock.type");if(0!==t)throw new Error(`Type mismatch in signatureUnlockBlock ${t}`);return{type:0,signature:et(e)}}function rt(e,t){e.writeByte("signatureUnlockBlock.type",t.type),tt(e,t.signature)}const st=Math.min(nt,3);function at(e){const t=e.readUInt16("transactionEssence.numUnlockBlocks"),n=[];for(let i=0;i<t;i++)n.push(dt(e));return n}function ot(e,t){e.writeUInt16("transactionEssence.numUnlockBlocks",t.length);for(let n=0;n<t.length;n++)ut(e,t[n])}function dt(e){if(!e.hasRemaining(st))throw new Error(`Unlock Block data is ${e.length()} in length which is less than the minimimum size required of ${st}`);const t=e.readByte("unlockBlock.type",!1);let n;if(0===t)n=it(e);else{if(1!==t)throw new Error(`Unrecognized unlock block type ${t}`);n=We(e)}return n}function ut(e,t){if(0===t.type)rt(e,t);else{if(1!==t.type)throw new Error(`Unrecognized unlock block type ${t.type}`);Ze(e,t)}}const lt=4+Q+9;const ct=Math.min(8,ce,9,pe,lt);function pt(e){const n=e.readUInt32("payload.length");if(!e.hasRemaining(n))throw new Error(`Payload length ${n} exceeds the remaining data ${e.unused()}`);let i;if(n>0){const n=e.readUInt32("payload.type",!1);if(0===n)i=function(e){if(!e.hasRemaining(8))throw new Error(`Transaction Payload data is ${e.length()} in length which is less than the minimimum size required of 8`);const t=e.readUInt32("payloadTransaction.type");if(0!==t)throw new Error(`Type mismatch in payloadTransaction ${t}`);let n,i;if(0!==e.readByte("payloadTransaction.essenceType",!1))throw new Error(`Unrecognized transaction essence type ${t}`);return n=qe(e),i=at(e),{type:0,essence:n,unlockBlocks:i}}(e);else if(1===n)i=function(e){if(!e.hasRemaining(ce))throw new Error(`Milestone Payload data is ${e.length()} in length which is less than the minimimum size required of ${ce}`);const n=e.readUInt32("payloadMilestone.type");if(1!==n)throw new Error(`Type mismatch in payloadMilestone ${n}`);const i=e.readUInt32("payloadMilestone.index"),r=e.readUInt64("payloadMilestone.timestamp"),s=e.readByte("payloadMilestone.numParents"),a=[];for(let t=0;t<s;t++){const n=e.readFixedHex(`payloadMilestone.parentMessageId${t+1}`,d);a.push(n)}const o=e.readFixedHex("payloadMilestone.inclusionMerkleProof",l),u=e.readUInt32("payloadMilestone.nextPoWScore"),c=e.readUInt32("payloadMilestone.nextPoWScoreMilestoneIndex"),p=e.readByte("payloadMilestone.publicKeysCount"),h=[];for(let n=0;n<p;n++)h.push(e.readFixedHex("payloadMilestone.publicKey",t.Ed25519.PUBLIC_KEY_SIZE));const m=pt(e);if(m&&3!==m.type)throw new Error("Milestones only support embedded receipt payload type");const f=e.readByte("payloadMilestone.signaturesCount"),y=[];for(let n=0;n<f;n++)y.push(e.readFixedHex("payloadMilestone.signature",t.Ed25519.SIGNATURE_SIZE));return{type:1,index:i,timestamp:Number(r),parentMessageIds:a,inclusionMerkleProof:o,nextPoWScore:u,nextPoWScoreMilestoneIndex:c,publicKeys:h,receipt:m,signatures:y}}(e);else if(2===n)i=function(e){if(!e.hasRemaining(9))throw new Error(`Indexation Payload data is ${e.length()} in length which is less than the minimimum size required of 9`);const t=e.readUInt32("payloadIndexation.type");if(2!==t)throw new Error(`Type mismatch in payloadIndexation ${t}`);const n=e.readUInt16("payloadIndexation.indexLength"),i=e.readFixedHex("payloadIndexation.index",n),r=e.readUInt32("payloadIndexation.dataLength");return{type:2,index:i,data:e.readFixedHex("payloadIndexation.data",r)}}(e);else if(3===n)i=function(e){if(!e.hasRemaining(pe))throw new Error(`Receipt Payload data is ${e.length()} in length which is less than the minimimum size required of ${pe}`);const t=e.readUInt32("payloadReceipt.type");if(3!==t)throw new Error(`Type mismatch in payloadReceipt ${t}`);const n=e.readUInt32("payloadReceipt.migratedAt"),i=e.readBoolean("payloadReceipt.final"),r=Z(e),s=pt(e);if(!s||4!==s.type)throw new Error(`payloadReceipts can only contain treasury payloads ${t}`);return{type:3,migratedAt:n,final:i,funds:r,transaction:s}}(e);else{if(4!==n)throw new Error(`Unrecognized payload type ${n}`);i=function(e){if(!e.hasRemaining(lt))throw new Error(`Treasury Transaction Payload data is ${e.length()} in length which is less than the minimimum size required of ${lt}`);const t=e.readUInt32("payloadTreasuryTransaction.type");if(4!==t)throw new Error(`Type mismatch in payloadTreasuryTransaction ${t}`);return{type:4,input:ee(e),output:ze(e)}}(e)}}return i}function ht(e,n){const i=e.getWriteIndex();if(e.writeUInt32("payload.length",0),n)if(0===n.type)!function(e,t){if(e.writeUInt32("payloadMilestone.type",t.type),0!==t.type)throw new Error(`Unrecognized transaction type ${t.type}`);Xe(e,t.essence),ot(e,t.unlockBlocks)}(e,n);else if(1===n.type)!function(e,n){if(e.writeUInt32("payloadMilestone.type",n.type),e.writeUInt32("payloadMilestone.index",n.index),e.writeUInt64("payloadMilestone.timestamp",s.default(n.timestamp)),n.parentMessageIds.length<gt)throw new Error(`A minimum of ${gt} parents is allowed, you provided ${n.parentMessageIds.length}`);if(n.parentMessageIds.length>yt)throw new Error(`A maximum of ${yt} parents is allowed, you provided ${n.parentMessageIds.length}`);if(new Set(n.parentMessageIds).size!==n.parentMessageIds.length)throw new Error("The milestone parents must be unique");const i=n.parentMessageIds.slice().sort();e.writeByte("payloadMilestone.numParents",n.parentMessageIds.length);for(let t=0;t<n.parentMessageIds.length;t++){if(i[t]!==n.parentMessageIds[t])throw new Error("The milestone parents must be lexographically sorted");e.writeFixedHex(`payloadMilestone.parentMessageId${t+1}`,d,n.parentMessageIds[t])}e.writeFixedHex("payloadMilestone.inclusionMerkleProof",l,n.inclusionMerkleProof),e.writeUInt32("payloadMilestone.nextPoWScore",n.nextPoWScore),e.writeUInt32("payloadMilestone.nextPoWScoreMilestoneIndex",n.nextPoWScoreMilestoneIndex),e.writeByte("payloadMilestone.publicKeysCount",n.publicKeys.length);for(let i=0;i<n.publicKeys.length;i++)e.writeFixedHex("payloadMilestone.publicKey",t.Ed25519.PUBLIC_KEY_SIZE,n.publicKeys[i]);ht(e,n.receipt),e.writeByte("payloadMilestone.signaturesCount",n.signatures.length);for(let i=0;i<n.signatures.length;i++)e.writeFixedHex("payloadMilestone.signature",t.Ed25519.SIGNATURE_SIZE,n.signatures[i])}(e,n);else if(2===n.type)!function(e,t){if(t.index.length<1)throw new Error(`The indexation key length is ${t.index.length}, which is below the minimum size of 1`);if(t.index.length/2>le)throw new Error(`The indexation key length is ${t.index.length/2}, which exceeds the maximum size of 64`);e.writeUInt32("payloadIndexation.type",t.type),e.writeUInt16("payloadIndexation.indexLength",t.index.length/2),e.writeFixedHex("payloadIndexation.index",t.index.length/2,t.index),t.data?(e.writeUInt32("payloadIndexation.dataLength",t.data.length/2),e.writeFixedHex("payloadIndexation.data",t.data.length/2,t.data)):e.writeUInt32("payloadIndexation.dataLength",0)}(e,n);else if(3===n.type)!function(e,t){e.writeUInt32("payloadReceipt.type",t.type),e.writeUInt32("payloadReceipt.migratedAt",t.migratedAt),e.writeBoolean("payloadReceipt.final",t.final),J(e,t.funds),ht(e,t.transaction)}(e,n);else{if(4!==n.type)throw new Error(`Unrecognized transaction type ${n.type}`);!function(e,t){e.writeUInt32("payloadTreasuryTransaction.type",t.type),te(e,t.input),be(e,t.output)}(e,n)}else;const r=e.getWriteIndex();e.setWriteIndex(i),e.writeUInt32("payload.length",r-i-4),e.setWriteIndex(r)}const mt=9+d+ct+8,ft=32768,yt=8,gt=1;function wt(e,t){var n,i,r,a;e.writeUInt64("message.networkId",s.default(null!==(n=t.networkId)&&void 0!==n?n:"0"));const o=null!==(r=null===(i=t.parentMessageIds)||void 0===i?void 0:i.length)&&void 0!==r?r:0;if(e.writeByte("message.numParents",o),t.parentMessageIds){if(o>yt)throw new Error(`A maximum of ${yt} parents is allowed, you provided ${o}`);if(new Set(t.parentMessageIds).size!==o)throw new Error("The message parents must be unique");const n=t.parentMessageIds.slice().sort();for(let i=0;i<o;i++){if(n[i]!==t.parentMessageIds[i])throw new Error("The message parents must be lexographically sorted");e.writeFixedHex(`message.parentMessageId${i+1}`,d,t.parentMessageIds[i])}}if(t.payload&&0!==t.payload.type&&2!==t.payload.type&&1!==t.payload.type)throw new Error("Messages can only contain transaction, indexation or milestone payloads");ht(e,t.payload),e.writeUInt64("message.nonce",s.default(null!==(a=t.nonce)&&void 0!==a?a:"0"))}class Tt extends Error{constructor(e,t,n,i){super(e),this.route=t,this.httpStatus=n,this.code=i}}class It{constructor(e,t){var n,i,r;if(!e)throw new Error("The endpoint can not be empty");if(this._endpoint=e.replace(/\/+$/,""),this._basePath=null!==(n=null==t?void 0:t.basePath)&&void 0!==n?n:"/api/v1/",this._powProvider=null==t?void 0:t.powProvider,this._timeout=null==t?void 0:t.timeout,this._userName=null==t?void 0:t.userName,this._password=null==t?void 0:t.password,this._headers=null==t?void 0:t.headers,this._userName&&this._password&&!this._endpoint.startsWith("https"))throw new Error("Basic authentication requires the endpoint to be https");if(this._userName&&this._password&&((null===(i=this._headers)||void 0===i?void 0:i.authorization)||(null===(r=this._headers)||void 0===r?void 0:r.Authorization)))throw new Error("You can not supply both user/pass and authorization header")}async health(){const e=await this.fetchStatus("/health");if(200===e)return!0;if(503===e)return!1;throw new Tt("Unexpected response code","/health",e)}async info(){return this.fetchJson("get","info")}async tips(){return this.fetchJson("get","tips")}async message(e){return this.fetchJson("get",`messages/${e}`)}async messageMetadata(e){return this.fetchJson("get",`messages/${e}/metadata`)}async messageRaw(e){return this.fetchBinary("get",`messages/${e}/raw`)}async messageSubmit(e){let t=0;if(this._powProvider){const n=await this.getPoWInfo();if(t=n.minPoWScore,!e.parentMessageIds||0===e.parentMessageIds.length){const t=await this.tips();e.parentMessageIds=t.tipMessageIds}e.networkId&&0!==e.networkId.length||(e.networkId=n.networkId.toString())}const n=new i.WriteStream;wt(n,e);const r=n.finalBytes();if(r.length>ft)throw new Error(`The message length is ${r.length}, which exceeds the maximum size of 32768`);if(this._powProvider){const n=await this._powProvider.pow(r,t);e.nonce=n.toString()}return(await this.fetchJson("post","messages",e)).messageId}async messageSubmitRaw(e){if(e.length>ft)throw new Error(`The message length is ${e.length}, which exceeds the maximum size of 32768`);if(this._powProvider&&t.ArrayHelper.equal(e.slice(-8),It.NONCE_ZERO)){const{networkId:t,minPoWScore:n}=await this.getPoWInfo();i.BigIntHelper.write8(t,e,0);const r=await this._powProvider.pow(e,n);i.BigIntHelper.write8(s.default(r),e,e.length-8)}return(await this.fetchBinary("post","messages",e)).messageId}async messagesFind(e){return this.fetchJson("get",`messages?index=${"string"==typeof e?i.Converter.utf8ToHex(e):i.Converter.bytesToHex(e)}`)}async messageChildren(e){return this.fetchJson("get",`messages/${e}/children`)}async transactionIncludedMessage(e){return this.fetchJson("get",`transactions/${e}/included-message`)}async output(e){return this.fetchJson("get",`outputs/${e}`)}async address(e){return this.fetchJson("get",`addresses/${e}`)}async addressOutputs(e,t,n){const i=[];return void 0!==t&&i.push(`type=${t}`),void 0!==n&&i.push(`include-spent=${n}`),this.fetchJson("get",`addresses/${e}/outputs${this.combineQueryParams(i)}`)}async addressEd25519(e){if(!i.Converter.isHex(e))throw new Error("The supplied address does not appear to be hex format");return this.fetchJson("get",`addresses/ed25519/${e}`)}async addressEd25519Outputs(e,t,n){if(!i.Converter.isHex(e))throw new Error("The supplied address does not appear to be hex format");const r=[];return void 0!==t&&r.push(`type=${t}`),void 0!==n&&r.push(`include-spent=${n}`),this.fetchJson("get",`addresses/ed25519/${e}/outputs${this.combineQueryParams(r)}`)}async milestone(e){return this.fetchJson("get",`milestones/${e}`)}async milestoneUtxoChanges(e){return this.fetchJson("get",`milestones/${e}/utxo-changes`)}async treasury(){return this.fetchJson("get","treasury")}async receipts(e){return this.fetchJson("get","receipts"+(void 0!==e?`/${e}`:""))}async peers(){return this.fetchJson("get","peers")}async peerAdd(e,t){return this.fetchJson("post","peers",{multiAddress:e,alias:t})}async peerDelete(e){return this.fetchJson("delete",`peers/${e}`)}async peer(e){return this.fetchJson("get",`peers/${e}`)}async fetchStatus(e){return(await this.fetchWithTimeout("get",e)).status}async fetchJson(e,t,n){const i=await this.fetchWithTimeout(e,`${this._basePath}${t}`,{"Content-Type":"application/json"},n?JSON.stringify(n):void 0);let r,s;if(i.ok){if(204===i.status)return{};try{const e=await i.json();if(!e.error)return e.data;r=e.error.message,s=e.error.code}catch{}}if(!r)try{const e=await i.json();e.error&&(r=e.error.message,s=e.error.code)}catch{}if(!r)try{const e=await i.text();if(e.length>0){const t=/code=(\d+), message=(.*)/.exec(e);3===(null==t?void 0:t.length)?(s=t[1],r=t[2]):r=e}}catch{}throw new Tt(null!=r?r:i.statusText,t,i.status,null!=s?s:i.status.toString())}async fetchBinary(e,t,n){var i,r,s;const a=await this.fetchWithTimeout(e,`${this._basePath}${t}`,{"Content-Type":"application/octet-stream"},n);let o;if(a.ok){if("get"===e)return new Uint8Array(await a.arrayBuffer());if(o=await a.json(),!(null==o?void 0:o.error))return null==o?void 0:o.data}throw o||(o=await a.json()),new Tt(null!==(r=null===(i=null==o?void 0:o.error)||void 0===i?void 0:i.message)&&void 0!==r?r:a.statusText,t,a.status,null===(s=null==o?void 0:o.error)||void 0===s?void 0:s.code)}async fetchWithTimeout(e,t,n,r){let s,a;void 0!==this._timeout&&(s=new AbortController,a=setTimeout((()=>{s&&s.abort()}),this._timeout));const o={};if(this._headers)for(const e in this._headers)o[e]=this._headers[e];if(n)for(const e in n)o[e]=n[e];if(this._userName&&this._password){const e=i.Converter.bytesToBase64(i.Converter.utf8ToBytes(`${this._userName}:${this._password}`));o.Authorization=`Basic ${e}`}try{return await fetch(`${this._endpoint}${t}`,{method:e,headers:o,body:r,signal:s?s.signal:void 0})}catch(e){throw e instanceof Error&&"AbortError"===e.name?new Error("Timeout"):e}finally{a&&clearTimeout(a)}}combineQueryParams(e){return e.length>0?`?${e.join("&")}`:""}async getPoWInfo(){const e=await this.info(),n=t.Blake2b.sum256(i.Converter.utf8ToBytes(e.networkId));return{networkId:i.BigIntHelper.read8(n,0),minPoWScore:e.minPoWScore}}}It.NONCE_ZERO=new Uint8Array([0,0,0,0,0,0,0,0]);class Et{static encodedLen(e){return e.length*Et.TRITS_PER_TRYTE}static encode(e,t,n){let i=0;for(let r=0;r<n.length;r++){const s=364+(n[r]<<24>>24),a=Math.trunc(s%27),o=Math.trunc(s/27);e[t+i]=Et.TRYTE_VALUE_TO_TRITS[a][0],e[t+i+1]=Et.TRYTE_VALUE_TO_TRITS[a][1],e[t+i+2]=Et.TRYTE_VALUE_TO_TRITS[a][2],e[t+i+3]=Et.TRYTE_VALUE_TO_TRITS[o][0],e[t+i+4]=Et.TRYTE_VALUE_TO_TRITS[o][1],e[t+i+5]=Et.TRYTE_VALUE_TO_TRITS[o][2],i+=6}return i}}Et.TRYTE_VALUE_TO_TRITS=[[-1,-1,-1],[0,-1,-1],[1,-1,-1],[-1,0,-1],[0,0,-1],[1,0,-1],[-1,1,-1],[0,1,-1],[1,1,-1],[-1,-1,0],[0,-1,0],[1,-1,0],[-1,0,0],[0,0,0],[1,0,0],[-1,1,0],[0,1,0],[1,1,0],[-1,-1,1],[0,-1,1],[1,-1,1],[-1,0,1],[0,0,1],[1,0,1],[-1,1,1],[0,1,1],[1,1,1]],Et.TRITS_PER_TRYTE=3;const _t="m/44'/4218'";function xt(e,n){n||(e.isInternal?(e.isInternal=!1,e.addressIndex++):e.isInternal=!0);const i=new t.Bip32Path(_t);return i.pushHardened(e.accountIndex),i.pushHardened(e.isInternal?1:0),i.pushHardened(e.addressIndex),i.toString()}class Ut{static toBech32(e,n,i){const r=new Uint8Array(1+n.length);return r[0]=e,r.set(n,1),t.Bech32.encode(i,r)}static fromBech32(e,n){const i=t.Bech32.decode(e);if(i){if(i.humanReadablePart!==n)throw new Error(`The hrp part of the address should be ${n}, it is ${i.humanReadablePart}`);if(0===i.data.length)throw new Error("The data part of the address should be at least length 1, it is 0");return{addressType:i.data[0],addressBytes:i.data.slice(1)}}}static matches(e,n){return t.Bech32.matches(n,e)}}async function $t(e,t,n,i){var r;return kt(e,t,{accountIndex:n,addressIndex:null!==(r=null==i?void 0:i.startIndex)&&void 0!==r?r:0,isInternal:!1},xt,i)}async function kt(e,n,r,s,o){var d,u;const l="string"==typeof e?new It(e):e,c=await l.info(),p=null!==(d=null==o?void 0:o.requiredCount)&&void 0!==d?d:Number.MAX_SAFE_INTEGER,h=null!==(u=null==o?void 0:o.zeroCount)&&void 0!==u?u:20;let m=!1;const f=[];let y=!0,g=0;do{const e=s(r,y);y=!1;const o=n.generateSeedFromPath(new t.Bip32Path(e)),d=new a(o.keyPair().publicKey).toAddress(),u=i.Converter.bytesToHex(d),w=await l.addressEd25519(u);0===w.balance?(g++,g>=h&&(m=!0)):(f.push({address:Ut.toBech32(0,d,c.bech32HRP),path:e,balance:w.balance}),f.length===p&&(m=!0))}while(!m);return f}async function Bt(e,t){const n="string"==typeof e?new It(e):e,i=await n.message(t);if(!i)throw new Error("The message does not exist.");const r=await n.tips();r.tipMessageIds.includes(t)||r.tipMessageIds.unshift(t),r.tipMessageIds.length>yt&&(r.tipMessageIds=r.tipMessageIds.slice(0,yt)),r.tipMessageIds.sort();const s={parentMessageIds:r.tipMessageIds};return{message:i,messageId:await n.messageSubmit(s)}}async function St(e,t){const n="string"==typeof e?new It(e):e,i=await n.message(t);if(!i)throw new Error("The message does not exist.");const r={payload:i.payload};return{message:i,messageId:await n.messageSubmit(r)}}async function Nt(e,t,n,i){const r="string"==typeof e?new It(e):e,s={payload:At(t,n,i)};return{messageId:await r.messageSubmit(s),message:s}}function At(e,n,r){if(!e||0===e.length)throw new Error("You must specify some inputs");if(!n||0===n.length)throw new Error("You must specify some outputs");let s;if(null==r?void 0:r.key){if(s="string"==typeof r.key?i.Converter.utf8ToHex(r.key):i.Converter.bytesToHex(r.key),s.length/2<1)throw new Error(`The indexation key length is ${s.length/2}, which is below the minimum size of 1`);if(s.length/2>le)throw new Error(`The indexation key length is ${s.length/2}, which exceeds the maximum size of 64`)}const a=[];for(const e of n){if(0!==e.addressType)throw new Error(`Unrecognized output address type ${e.addressType}`);{const t={type:0,address:{type:e.addressType,address:e.address},amount:e.amount},n=new i.WriteStream;Ye(n,t),a.push({output:t,serialized:n.finalHex()})}}const o=e.map((e=>{const t=new i.WriteStream;return ue(t,e.input),{...e,serialized:t.finalHex()}})).sort(((e,t)=>e.serialized.localeCompare(t.serialized))),d=a.sort(((e,t)=>e.serialized.localeCompare(t.serialized))),u={type:0,inputs:o.map((e=>e.input)),outputs:d.map((e=>e.output)),payload:s?{type:2,index:s,data:(null==r?void 0:r.data)?"string"==typeof r.data?i.Converter.utf8ToHex(r.data):i.Converter.bytesToHex(r.data):void 0}:void 0},l=new i.WriteStream;Xe(l,u);const c=l.finalBytes(),p=t.Blake2b.sum256(c),h=[],m={};for(const e of o){const n=i.Converter.bytesToHex(e.addressKeyPair.publicKey);m[n]?h.push({type:1,reference:m[n].unlockIndex}):(h.push({type:0,signature:{type:0,publicKey:n,signature:i.Converter.bytesToHex(t.Ed25519.sign(e.addressKeyPair.privateKey,p))}}),m[n]={keyPair:e.addressKeyPair,unlockIndex:h.length-1})}return{type:0,essence:u,unlockBlocks:h}}async function Mt(e,t,n,r,s,a){var o;const d="string"==typeof e?new It(e):e,u=await d.info(),l=r.map((e=>{const t=Ut.fromBech32(e.addressBech32,u.bech32HRP);if(!t)throw new Error("Unable to decode bech32 address");return{address:i.Converter.bytesToHex(t.addressBytes),addressType:t.addressType,amount:e.amount}}));return Pt(e,t,{accountIndex:n,addressIndex:null!==(o=null==a?void 0:a.startIndex)&&void 0!==o?o:0,isInternal:!1},xt,l,s,null==a?void 0:a.zeroCount)}async function Ot(e,t,n,i,r,s){var a;const o=i.map((e=>({address:e.addressEd25519,addressType:0,amount:e.amount})));return Pt(e,t,{accountIndex:n,addressIndex:null!==(a=null==s?void 0:s.startIndex)&&void 0!==a?a:0,isInternal:!1},xt,o,r,null==s?void 0:s.zeroCount)}async function Pt(e,t,n,i,r,s,a){const o=await Ft(e,t,n,i,r,a),d=await Nt(e,o,r,s);return{messageId:d.messageId,message:d.message}}async function Ft(e,n,r,s,o,d=5){const u="string"==typeof e?new It(e):e;let l=0;for(const e of o)l+=e.amount;let c=0;const p=[];let h=!1,m=!0,f=0;do{const e=s(r,m);m=!1;const y=n.generateSeedFromPath(new t.Bip32Path(e)).keyPair(),g=new a(y.publicKey),w=i.Converter.bytesToHex(g.toAddress()),T=await u.addressEd25519Outputs(w);if(0===T.count)f++,f>=d&&(h=!0);else for(const e of T.outputIds){const t=await u.output(e);if(!t.isSpent&&c<l)if(0===t.output.amount)f++,f>=d&&(h=!0);else{c+=t.output.amount;const e={type:0,transactionId:t.transactionId,transactionOutputIndex:t.outputIndex};p.push({input:e,addressKeyPair:y}),c>=l&&(c-l>0&&0===t.output.type&&o.push({amount:c-l,address:t.output.address.address,addressType:t.output.address.type}),h=!0)}}}while(!h);if(c<l)throw new Error("There are not enough funds in the inputs for the required balance");return p}var Rt;Ut.BECH32_DEFAULT_HRP_MAIN="iota",Ut.BECH32_DEFAULT_HRP_DEV="atoi",e.ConflictReason=void 0,(Rt=e.ConflictReason||(e.ConflictReason={}))[Rt.none=0]="none",Rt[Rt.inputUTXOAlreadySpent=1]="inputUTXOAlreadySpent",Rt[Rt.inputUTXOAlreadySpentInThisMilestone=2]="inputUTXOAlreadySpentInThisMilestone",Rt[Rt.inputUTXONotFound=3]="inputUTXONotFound",Rt[Rt.inputOutputSumMismatch=4]="inputOutputSumMismatch",Rt[Rt.invalidSignature=5]="invalidSignature",Rt[Rt.invalidDustAllowance=6]="invalidDustAllowance",Rt[Rt.semanticValidationFailed=255]="semanticValidationFailed";class Lt{static score(e){const n=e.slice(0,-8),r=t.Blake2b.sum256(n),s=i.BigIntHelper.read8(e,e.length-8),a=Lt.trailingZeros(r,s);return Math.pow(3,a)/e.length}static calculateTargetZeros(e,t){return Math.ceil(Math.log(e.length*t)/this.LN3)}static trailingZeros(e,n){const r=new Int8Array(t.Curl.HASH_LENGTH),s=Et.encode(r,0,e),a=new Uint8Array(8);i.BigIntHelper.write8(n,a,0),Et.encode(r,s,a);const o=new t.Curl;o.absorb(r,0,t.Curl.HASH_LENGTH);const d=new Int8Array(t.Curl.HASH_LENGTH);return o.squeeze(d,0,t.Curl.HASH_LENGTH),Lt.trinaryTrailingZeros(d)}static trinaryTrailingZeros(e,t=e.length){let n=0;for(let i=t-1;i>=0&&0===e[i];i--)n++;return n}static performPow(e,n,r){let a,o=s.default(r);const d=new Int8Array(t.Curl.HASH_LENGTH),u=Et.encode(d,0,e),l=new Uint8Array(8);do{i.BigIntHelper.write8(o,l,0),Et.encode(d,u,l);const e=new Int8Array(t.Curl.STATE_LENGTH);e.set(d,0),t.Curl.transform(e,81),Lt.trinaryTrailingZeros(e,t.Curl.HASH_LENGTH)>=n?a=o:o=o.plus(1)}while(void 0===a);return a?a.toString():"0"}}Lt.LN3=1.0986122886681098;const vt={[e.ConflictReason.none]:"Not conflicting",[e.ConflictReason.inputUTXOAlreadySpent]:"The referenced UTXO was already spent",[e.ConflictReason.inputUTXOAlreadySpentInThisMilestone]:"The referenced UTXO was already spent while confirming this milestone",[e.ConflictReason.inputUTXONotFound]:"The referenced UTXO cannot be found",[e.ConflictReason.inputOutputSumMismatch]:"The sum of the inputs and output values does not match",[e.ConflictReason.invalidSignature]:"The unlock block signature is invalid",[e.ConflictReason.invalidDustAllowance]:"The dust allowance for the address is invalid",[e.ConflictReason.semanticValidationFailed]:"The semantic validation failed"};class Ht{constructor(e){this._secretKey=null!=e?e:new Uint8Array}static fromMnemonic(e){return new Ht(t.Bip39.mnemonicToSeed(e))}keyPair(){const e=t.Ed25519.keyPairFromSeed(this._secretKey);return{publicKey:e.publicKey,privateKey:e.privateKey}}generateSeedFromPath(e){const n=t.Slip0010.derivePath(this._secretKey,e);return new Ht(n.privateKey)}toBytes(){return this._secretKey}}let zt=(e,t)=>void 0!==t?console.log(e,t):console.log(e);function bt(e,t){t&&(0===t.type?Ct(e,t):1===t.type?Kt(e,t):2===t.type?Dt(e,t):3===t.type?Gt(e,t):4===t.type&&Yt(e,t))}function Ct(e,t){if(t){if(zt(`${e}Transaction Payload`),0===t.essence.type){if(t.essence.inputs){zt(`${e}\tInputs:`,t.essence.inputs.length);for(const n of t.essence.inputs)Wt(`${e}\t\t`,n)}if(t.essence.outputs){zt(`${e}\tOutputs:`,t.essence.outputs.length);for(const n of t.essence.outputs)Zt(`${e}\t\t`,n)}}if(t.unlockBlocks){zt(`${e}\tUnlock Blocks:`,t.unlockBlocks.length);for(const n of t.unlockBlocks)Jt(`${e}\t\t`,n)}}}function Dt(e,t){t&&(zt(`${e}Indexation Payload`),zt(`${e}\tIndex:`,i.Converter.hexToUtf8(t.index)),zt(`${e}\tData:`,t.data?i.Converter.hexToUtf8(t.data):"None"))}function Kt(e,t){if(t){zt(`${e}Milestone Payload`),zt(`${e}\tIndex:`,t.index),zt(`${e}\tTimestamp:`,t.timestamp);for(let n=0;n<t.parentMessageIds.length;n++)zt(`${e}\tParent ${n+1}:`,t.parentMessageIds[n]);zt(`${e}\tInclusion Merkle Proof:`,t.inclusionMerkleProof),t.nextPoWScore&&zt(`${e}\tNext PoW Score:`,t.nextPoWScore),t.nextPoWScoreMilestoneIndex&&zt(`${e}\tNext PoW Score Milestone Index:`,t.nextPoWScoreMilestoneIndex),zt(`${e}\tPublic Keys:`,t.publicKeys),zt(`${e}\tSignatures:`,t.signatures),Gt(`${e}\t`,t.receipt)}}function Gt(e,t){if(t){zt(`${e}Receipt Payload`),zt(`${e}\tMigrated At:`,t.migratedAt),zt(`${e}\tFinal:`,t.final),zt(`${e}\tFunds:`,t.funds.length);for(const n of t.funds)jt(`${e}\t\t`,n);Yt(`${e}\t\t`,t.transaction)}}function Yt(e,t){t&&(zt(`${e}Treasury Transaction Payload`),Wt(e,t.input),Zt(e,t.output))}function qt(e,t){0===(null==t?void 0:t.type)?(zt(`${e}Ed25519 Address`),zt(`${e}\tAddress:`,t.address)):1===(null==t?void 0:t.type)?(zt(`${e}BLS Address`),zt(`${e}\tAddress:`,t.address)):8===(null==t?void 0:t.type)?(zt(`${e}Alias Address`),zt(`${e}\tAddress:`,t.address)):(null==t?void 0:t.type)===o&&(zt(`${e}NFT Address`),zt(`${e}\tAddress:`,t.address))}function Xt(e,t){0===(null==t?void 0:t.type)&&(zt(`${e}Ed25519 Signature`),zt(`${e}\tPublic Key:`,t.publicKey),zt(`${e}\tSignature:`,t.signature))}function Wt(e,t){t&&(0===t.type?(zt(`${e}UTXO Input`),zt(`${e}\tTransaction Id:`,t.transactionId),zt(`${e}\tTransaction Output Index:`,t.transactionOutputIndex)):1===t.type&&(zt(`${e}Treasury Input`),zt(`${e}\tMilestone Hash:`,t.milestoneId)))}function Zt(e,t){t&&(0===t.type?(zt(`${e}Signature Locked Single Output`),qt(`${e}\t\t`,t.address),zt(`${e}\t\tAmount:`,t.amount)):1===t.type?(zt(`${e}Signature Locked Dust Allowance Output`),qt(`${e}\t\t`,t.address),zt(`${e}\t\tAmount:`,t.amount)):2===t.type?(zt(`${e}Treasury Output`),zt(`${e}\t\tAmount:`,t.amount)):3===t.type?(zt(`${e}Extended Output`),qt(`${e}\t\tS`,t.address),zt(`${e}\t\tAmount:`,t.amount),Vt(`${e}\t\t`,t.nativeTokens),en(`${e}\t\t`,t.blocks)):4===t.type?(zt(`${e}Alias Output`),zt(`${e}\t\tAmount:`,t.amount),Vt(`${e}\t\t`,t.nativeTokens),zt(`${e}\t\tAlias Id:`,t.aliasId),zt(`${e}State Controller`),qt(`${e}\t\t`,t.stateController),zt(`${e}Governance Controller`),qt(`${e}\t\t`,t.governanceController),zt(`${e}\t\tState Index:`,t.stateIndex),zt(`${e}\t\tState Metadata:`,t.stateMetadata),zt(`${e}\t\tFoundry Counter:`,t.foundryCounter),en(`${e}\t\t`,t.blocks)):5===t.type?(zt(`${e}Foundry Output`),zt(`${e}\t\tAmount:`,t.amount),Vt(`${e}\t\t`,t.nativeTokens),qt(`${e}\t\tS`,t.address),zt(`${e}\t\tSerial Number:`,t.serialNumber),zt(`${e}\t\tToken Tag:`,t.tokenTag),zt(`${e}\t\tCirculating Supply:`,t.circulatingSupply),zt(`${e}\t\tMaximum Supply:`,t.maximumSupply),zt(`${e}State Controller`),Qt(`${e}\t\t`,t.tokenScheme),en(`${e}\t\t`,t.blocks)):6===t.type&&(zt(`${e}NFT Output`),qt(`${e}\t\tS`,t.address),zt(`${e}\t\tAmount:`,t.amount),Vt(`${e}\t\t`,t.nativeTokens),zt(`${e}\t\tNFT Id:`,t.nftId),zt(`${e}\t\tImmutable Data:`,t.immutableData),en(`${e}\t\t`,t.blocks)))}function Jt(e,t){t&&(0===t.type?(zt(`${e}\tSignature Unlock Block`),Xt(`${e}\t\t`,t.signature)):1===t.type?(zt(`${e}\tReference Unlock Block`),zt(`${e}\t\tReference:`,t.reference)):2===t.type?(zt(`${e}\tAlias Unlock Block`),zt(`${e}\t\tReference:`,t.reference)):3===t.type&&(zt(`${e}\tNFT Unlock Block`),zt(`${e}\t\tReference:`,t.reference)))}function jt(e,t){t&&(zt(`${e}\tFund`),zt(`${e}\t\tTail Transaction Hash:`,t.tailTransactionHash),qt(`${e}\t\t`,t.address),zt(`${e}\t\tDeposit:`,t.deposit))}function Vt(e,t){zt(`${e}Native Tokens`);for(const n of t)zt(`${e}\t\tId:`,n.id),zt(`${e}\t\tAmount:`,n.amount)}function Qt(e,t){0===t.type&&zt(`${e}\tSimple Token Scheme`)}function en(e,t){zt(`${e}Native Tokens`);for(const n of t)tn(`${e}\t\t`,n)}function tn(e,t){0===t.type?(zt(`${e}\tSender Feature Block`),qt(`${e}\t\t`,t.address)):1===t.type?(zt(`${e}\tIssuer Feature Block`),qt(`${e}\t\t`,t.address)):2===t.type?(zt(`${e}\tReturn Feature Block`),zt(`${e}\t\tAmount:`,t.amount)):3===t.type?(zt(`${e}\tTimelock Milestone Index Feature Block`),zt(`${e}\t\tMilestone Index:`,t.milestoneIndex)):4===t.type?(zt(`${e}\tTimelock Unix Feature Block`),zt(`${e}\t\tUnix Time:`,t.unixTime)):5===t.type?(zt(`${e}\tExpiration Milestone Index Feature Block`),zt(`${e}\t\tMilestone Index:`,t.milestoneIndex)):6===t.type?(zt(`${e}\tExpiration Unix Feature Block`),zt(`${e}\t\tUnix Time:`,t.unixTime)):7===t.type?(zt(`${e}\tMetadata Feature Block`),zt(`${e}\t\tData:`,t.data)):8===t.type&&(zt(`${e}\tIndexation Feature Block`),zt(`${e}\t\tIndexation Tag:`,t.tag))}class nn{static formatBest(e,t=2){return nn.formatUnits(e,nn.calculateBest(e),t)}static formatUnits(e,t,n=2){if(!nn.UNIT_MAP[t])throw new Error(`Unrecognized unit ${t}`);return e?"i"===t?`${e} i`:`${nn.convertUnits(e,"i",t).toFixed(n)} ${t}`:`0 ${t}`}static calculateBest(e){let t="i";if(!e)return t;const n=Math.abs(e).toString().length;return n>nn.UNIT_MAP.Pi.dp?t="Pi":n>nn.UNIT_MAP.Ti.dp?t="Ti":n>nn.UNIT_MAP.Gi.dp?t="Gi":n>nn.UNIT_MAP.Mi.dp?t="Mi":n>nn.UNIT_MAP.Ki.dp&&(t="Ki"),t}static convertUnits(e,t,n){if(!e)return 0;if(!nn.UNIT_MAP[t])throw new Error(`Unrecognized fromUnit ${t}`);if(!nn.UNIT_MAP[n])throw new Error(`Unrecognized toUnit ${n}`);if("i"===t&&e%1!=0)throw new Error("If fromUnit is 'i' the value must be an integer value");if(t===n)return Number(e);const i=e<0?-1:1,r=Math.abs(Number(e))*nn.UNIT_MAP[t].val/nn.UNIT_MAP[n].val,s=nn.UNIT_MAP[n].dp;let a=r.toString();a.includes("e")&&(a=r.toFixed(Number.parseInt(a.split("-")[1],10)));const o=a.split(".");return 1===o.length&&o.push("0"),o[1]=o[1].slice(0,s),Number.parseFloat(`${o[0]}.${o[1]}`)*i}}nn.UNIT_MAP={i:{val:1,dp:0},Ki:{val:1e3,dp:3},Mi:{val:1e6,dp:6},Gi:{val:1e9,dp:9},Ti:{val:1e12,dp:12},Pi:{val:1e15,dp:15}},e.ALIAS_ADDRESS_LENGTH=20,e.ALIAS_ADDRESS_TYPE=8,e.ALIAS_ID_LENGTH=20,e.ALIAS_OUTPUT_TYPE=4,e.ALIAS_UNLOCK_BLOCK_TYPE=2,e.ARRAY_LENGTH=2,e.B1T6=Et,e.BLS_ADDRESS_LENGTH=32,e.BLS_ADDRESS_TYPE=1,e.Bech32Helper=Ut,e.CONFLICT_REASON_STRINGS=vt,e.ClientError=Tt,e.ED25519_ADDRESS_TYPE=0,e.ED25519_SEED_TYPE=1,e.ED25519_SIGNATURE_TYPE=0,e.EXPIRATION_MILESTONE_INDEX_FEATURE_BLOCK_TYPE=5,e.EXPIRATION_UNIX_FEATURE_BLOCK_TYPE=6,e.EXTENDED_OUTPUT_TYPE=3,e.Ed25519Address=a,e.Ed25519Seed=Ht,e.FOUNDRY_OUTPUT_TYPE=5,e.INDEXATION_FEATURE_BLOCK_TYPE=8,e.INDEXATION_PAYLOAD_TYPE=2,e.IOTA_BIP44_BASE_PATH=_t,e.ISSUER_FEATURE_BLOCK_TYPE=1,e.LocalPowProvider=class{async pow(e,n){const i=e.slice(0,-8),r=t.Blake2b.sum256(i),s=Lt.calculateTargetZeros(e,n);return Lt.performPow(r,s,"0").toString()}},e.MAX_FUNDS_COUNT=127,e.MAX_INPUT_COUNT=127,e.MAX_MESSAGE_LENGTH=ft,e.MAX_NUMBER_PARENTS=yt,e.MAX_OUTPUT_COUNT=127,e.MERKLE_PROOF_LENGTH=l,e.MESSAGE_ID_LENGTH=d,e.METADATA_FEATURE_BLOCK_TYPE=7,e.MILESTONE_PAYLOAD_TYPE=1,e.MIN_ADDRESS_LENGTH=I,e.MIN_ALIAS_ADDRESS_LENGTH=21,e.MIN_ALIAS_OUTPUT_LENGTH=ge,e.MIN_ALIAS_UNLOCK_BLOCK_LENGTH=3,e.MIN_BLS_ADDRESS_LENGTH=33,e.MIN_ED25519_ADDRESS_LENGTH=f,e.MIN_ED25519_SIGNATURE_LENGTH=Je,e.MIN_EXPIRATION_MILESTONE_INDEX_FEATURE_BLOCK_LENGTH=5,e.MIN_EXPIRATION_UNIX_FEATURE_BLOCK_LENGTH=5,e.MIN_EXTENDED_OUTPUT_LENGTH=Ie,e.MIN_FEATURE_BLOCKS_LENGTH=2,e.MIN_FEATURE_BLOCK_LENGTH=K,e.MIN_FOUNDRY_OUTPUT_LENGTH=Be,e.MIN_INDEXATION_FEATURE_BLOCK_LENGTH=5,e.MIN_INPUT_COUNT=1,e.MIN_INPUT_LENGTH=se,e.MIN_ISSUER_FEATURE_BLOCK_LENGTH=N,e.MIN_METADATA_FEATURE_BLOCK_LENGTH=5,e.MIN_MIGRATED_FUNDS_LENGTH=W,e.MIN_NFT_ADDRESS_LENGTH=21,e.MIN_NFT_OUTPUT_LENGTH=Ae,e.MIN_NFT_UNLOCK_BLOCK_LENGTH=3,e.MIN_NUMBER_PARENTS=gt,e.MIN_OUTPUT_COUNT=1,e.MIN_OUTPUT_LENGTH=Ce,e.MIN_PAYLOAD_LENGTH=ct,e.MIN_REFERENCE_UNLOCK_BLOCK_LENGTH=3,e.MIN_RETURN_FEATURE_BLOCK_LENGTH=9,e.MIN_SENDER_FEATURE_BLOCK_LENGTH=L,e.MIN_SIGNATURE_LENGTH=Qe,e.MIN_SIGNATURE_UNLOCK_BLOCK_LENGTH=nt,e.MIN_SIG_LOCKED_DUST_ALLOWANCE_OUTPUT_LENGTH=Pe,e.MIN_SIMPLE_OUTPUT_LENGTH=Le,e.MIN_SIMPLE_TOKEN_SCHEME_LENGTH=1,e.MIN_TIMELOCK_MILESTONE_INDEX_FEATURE_BLOCK_LENGTH=5,e.MIN_TIMELOCK_UNIX_FEATURE_BLOCK_LENGTH=5,e.MIN_TOKEN_SCHEME_LENGTH=1,e.MIN_TRANSACTION_ESSENCE_LENGTH=9,e.MIN_TREASURY_INPUT_LENGTH=Q,e.MIN_TREASURY_OUTPUT_LENGTH=9,e.MIN_UNLOCK_BLOCK_LENGTH=st,e.MIN_UTXO_INPUT_LENGTH=ne,e.NFT_ADDRESS_LENGTH=20,e.NFT_ADDRESS_TYPE=o,e.NFT_ID_LENGTH=20,e.NFT_OUTPUT_TYPE=6,e.NFT_UNLOCK_BLOCK_TYPE=3,e.PowHelper=Lt,e.RECEIPT_PAYLOAD_TYPE=3,e.REFERENCE_UNLOCK_BLOCK_TYPE=1,e.RETURN_FEATURE_BLOCK_TYPE=2,e.SENDER_FEATURE_BLOCK_TYPE=0,e.SIGNATURE_UNLOCK_BLOCK_TYPE=0,e.SIG_LOCKED_DUST_ALLOWANCE_OUTPUT_TYPE=1,e.SIMPLE_OUTPUT_TYPE=0,e.SIMPLE_TOKEN_SCHEME_TYPE=0,e.SMALL_TYPE_LENGTH=1,e.STRING_LENGTH=2,e.SingleNodeClient=It,e.TAIL_HASH_LENGTH=49,e.TIMELOCK_MILESTONE_INDEX_FEATURE_BLOCK_TYPE=3,e.TIMELOCK_UNIX_FEATURE_BLOCK_TYPE=4,e.TRANSACTION_ESSENCE_TYPE=0,e.TRANSACTION_ID_LENGTH=u,e.TRANSACTION_PAYLOAD_TYPE=0,e.TREASURY_INPUT_TYPE=1,e.TREASURY_OUTPUT_TYPE=2,e.TREASURY_TRANSACTION_PAYLOAD_TYPE=4,e.TYPE_LENGTH=4,e.UINT16_SIZE=2,e.UINT256_SIZE=32,e.UINT32_SIZE=4,e.UINT64_SIZE=8,e.UINT8_SIZE=1,e.UTXO_INPUT_TYPE=0,e.UnitsHelper=nn,e.buildTransactionPayload=At,e.calculateInputs=Ft,e.deserializeAddress=E,e.deserializeAliasAddress=c,e.deserializeAliasOutput=we,e.deserializeAliasUnlockBlock=function(e){if(!e.hasRemaining(3))throw new Error(`Alias Unlock Block data is ${e.length()} in length which is less than the minimimum size required of 3`);const t=e.readByte("aliasUnlockBlock.type");if(2!==t)throw new Error(`Type mismatch in aliasUnlockBlock ${t}`);return{type:2,reference:e.readUInt16("aliasUnlockBlock.reference")}},e.deserializeBlsAddress=h,e.deserializeEd25519Address=y,e.deserializeEd25519Signature=je,e.deserializeExpirationMilestoneIndexFeatureBlock=x,e.deserializeExpirationUnixFeatureBlock=$,e.deserializeExtendedOutput=Ee,e.deserializeFeatureBlock=q,e.deserializeFeatureBlocks=G,e.deserializeFoundryOutput=Se,e.deserializeFunds=Z,e.deserializeIndexationFeatureBlock=B,e.deserializeInput=de,e.deserializeInputs=ae,e.deserializeIssuerFeatureBlock=A,e.deserializeMessage=function(e){if(!e.hasRemaining(mt))throw new Error(`Message data is ${e.length()} in length which is less than the minimimum size required of ${mt}`);const t=e.readUInt64("message.networkId"),n=e.readByte("message.numParents"),i=[];for(let t=0;t<n;t++){const n=e.readFixedHex(`message.parentMessageId${t}`,d);i.push(n)}const r=pt(e);if(r&&(3===r.type||4===r.type))throw new Error("Messages can not contain receipt or treasury transaction payloads");const s=e.readUInt64("message.nonce"),a=e.unused();if(0!==a)throw new Error(`Message data length ${e.length()} has unused data ${a}`);return{networkId:t.toString(10),parentMessageIds:i,payload:r,nonce:s.toString(10)}},e.deserializeMetadataFeatureBlock=O,e.deserializeMigratedFunds=j,e.deserializeNftAddress=w,e.deserializeNftOutput=Me,e.deserializeNftUnlockBlock=function(e){if(!e.hasRemaining(3))throw new Error(`Nft Unlock Block data is ${e.length()} in length which is less than the minimimum size required of 3`);const t=e.readByte("nftUnlockBlock.type");if(3!==t)throw new Error(`Type mismatch in nftUnlockBlock ${t}`);return{type:3,reference:e.readUInt16("nftUnlockBlock.reference")}},e.deserializeOutput=Ge,e.deserializeOutputs=De,e.deserializePayload=pt,e.deserializeReferenceUnlockBlock=We,e.deserializeReturnFeatureBlock=F,e.deserializeSenderFeatureBlock=v,e.deserializeSigLockedDustAllowanceOutput=Fe,e.deserializeSignature=et,e.deserializeSignatureUnlockBlock=it,e.deserializeSimpleOutput=ve,e.deserializeSimpleTokenScheme=xe,e.deserializeTimelockMilestoneIndexFeatureBlock=z,e.deserializeTimelockUnixFeatureBlock=C,e.deserializeTokenScheme=$e,e.deserializeTransactionEssence=qe,e.deserializeTreasuryInput=ee,e.deserializeTreasuryOutput=ze,e.deserializeUTXOInput=ie,e.deserializeUnlockBlock=dt,e.deserializeUnlockBlocks=at,e.generateBip44Address=xt,e.generateBip44Path=function(e,n,i){const r=new t.Bip32Path(_t);return r.pushHardened(e),r.pushHardened(i?1:0),r.pushHardened(n),r},e.getBalance=async function(e,t,n,i){const r=await $t(e,t,n,i);let s=0;for(const e of r)s+=e.balance;return s},e.getUnspentAddress=async function(e,t,n,i){const r=await $t(e,t,n,{startIndex:null==i?void 0:i.startIndex,zeroCount:null==i?void 0:i.zeroCount,requiredCount:1});return r.length>0?r[0]:void 0},e.getUnspentAddresses=$t,e.getUnspentAddressesWithAddressGenerator=kt,e.logAddress=qt,e.logFeatureBlock=tn,e.logFeatureBlocks=en,e.logFunds=jt,e.logIndexationPayload=Dt,e.logInfo=function(e,t){zt(`${e}\tName:`,t.name),zt(`${e}\tVersion:`,t.version),zt(`${e}\tNetwork Id:`,t.networkId),zt(`${e}\tIs Healthy:`,t.isHealthy),zt(`${e}\tMin PoW Score:`,t.minPoWScore),zt(`${e}\tBech32 HRP:`,t.bech32HRP),zt(`${e}\tLatest Milestone Index:`,t.latestMilestoneIndex),zt(`${e}\tLatest Milestone Timestamp:`,t.latestMilestoneTimestamp),zt(`${e}\tConfirmed Milestone Index:`,t.confirmedMilestoneIndex),zt(`${e}\tMessages Per Second:`,t.messagesPerSecond),zt(`${e}\tReferenced Messages Per Second:`,t.referencedMessagesPerSecond),zt(`${e}\tReferenced Rate:`,t.referencedRate),zt(`${e}\tPruning Index:`,t.pruningIndex),zt(`${e}\tFeatures:`,t.features)},e.logInput=Wt,e.logMessage=function(e,t){if(zt(`${e}\tNetwork Id:`,t.networkId),t.parentMessageIds)for(let n=0;n<t.parentMessageIds.length;n++)zt(`${e}\tParent ${n+1} Message Id:`,t.parentMessageIds[n]);bt(`${e}\t`,t.payload),void 0!==t.nonce&&zt(`${e}\tNonce:`,t.nonce)},e.logMessageMetadata=function(e,t){if(zt(`${e}\tMessage Id:`,t.messageId),t.parentMessageIds)for(let n=0;n<t.parentMessageIds.length;n++)zt(`${e}\tParent ${n+1} Message Id:`,t.parentMessageIds[n]);void 0!==t.isSolid&&zt(`${e}\tIs Solid:`,t.isSolid),void 0!==t.milestoneIndex&&zt(`${e}\tMilestone Index:`,t.milestoneIndex),void 0!==t.referencedByMilestoneIndex&&zt(`${e}\tReferenced By Milestone Index:`,t.referencedByMilestoneIndex),zt(`${e}\tLedger Inclusion State:`,t.ledgerInclusionState),void 0!==t.conflictReason&&zt(`${e}\tConflict Reason:`,t.conflictReason),void 0!==t.shouldPromote&&zt(`${e}\tShould Promote:`,t.shouldPromote),void 0!==t.shouldReattach&&zt(`${e}\tShould Reattach:`,t.shouldReattach)},e.logMilestonePayload=Kt,e.logNativeTokens=Vt,e.logOutput=Zt,e.logPayload=bt,e.logReceiptPayload=Gt,e.logSignature=Xt,e.logTips=function(e,t){if(t.tipMessageIds)for(let n=0;n<t.tipMessageIds.length;n++)zt(`${e}\tTip ${n+1} Message Id:`,t.tipMessageIds[n])},e.logTokenScheme=Qt,e.logTransactionPayload=Ct,e.logTreasuryTransactionPayload=Yt,e.logUnlockBlock=Jt,e.promote=Bt,e.reattach=St,e.retrieveData=async function(e,t){const n="string"==typeof e?new It(e):e,r=await n.message(t);if(null==r?void 0:r.payload){let e;if(0===r.payload.type?e=r.payload.essence.payload:2===r.payload.type&&(e=r.payload),e)return{index:i.Converter.hexToBytes(e.index),data:e.data?i.Converter.hexToBytes(e.data):void 0}}},e.retry=async function(e,t){const n="string"==typeof e?new It(e):e,i=await n.messageMetadata(t);if(!i)throw new Error("The message does not exist.");if(i.shouldPromote)return Bt(e,t);if(i.shouldReattach)return St(e,t);throw new Error("The message should not be promoted or reattached.")},e.send=async function(e,t,n,i,r,s,a){return Mt(e,t,n,[{addressBech32:i,amount:r}],s,a)},e.sendAdvanced=Nt,e.sendData=async function(e,t,n){const r="string"==typeof e?new It(e):e;if(!t)throw new Error("indexationKey must not be empty");const s="string"==typeof t?i.Converter.utf8ToHex(t):i.Converter.bytesToHex(t);if(s.length/2<1)throw new Error(`The indexation key length is ${s.length/2}, which is below the minimum size of 1`);if(s.length/2>le)throw new Error(`The indexation key length is ${s.length/2}, which exceeds the maximum size of 64`);const a={payload:{type:2,index:s,data:n?"string"==typeof n?i.Converter.utf8ToHex(n):i.Converter.bytesToHex(n):void 0}};return{message:a,messageId:await r.messageSubmit(a)}},e.sendEd25519=async function(e,t,n,i,r,s,a){return Ot(e,t,n,[{addressEd25519:i,amount:r}],s,a)},e.sendMultiple=Mt,e.sendMultipleEd25519=Ot,e.sendWithAddressGenerator=Pt,e.serializeAddress=_,e.serializeAliasAddress=p,e.serializeAliasOutput=Te,e.serializeAliasUnlockBlock=function(e,t){e.writeByte("aliasUnlockBlock.type",t.type),e.writeUInt16("aliasUnlockBlock.reference",t.reference)},e.serializeBlsAddress=m,e.serializeEd25519Address=g,e.serializeEd25519Signature=Ve,e.serializeExpirationMilestoneIndexFeatureBlock=U,e.serializeExpirationUnixFeatureBlock=k,e.serializeExtendedOutput=_e,e.serializeFeatureBlock=X,e.serializeFeatureBlocks=Y,e.serializeFoundryOutput=Ne,e.serializeFunds=J,e.serializeIndexationFeatureBlock=S,e.serializeInput=ue,e.serializeInputs=oe,e.serializeIssuerFeatureBlock=M,e.serializeMessage=wt,e.serializeMetadataFeatureBlock=P,e.serializeMigratedFunds=V,e.serializeNftAddress=T,e.serializeNftOutput=Oe,e.serializeNftUnlockBlock=function(e,t){e.writeByte("nftUnlockBlock.type",t.type),e.writeUInt16("nftUnlockBlock.reference",t.reference)},e.serializeOutput=Ye,e.serializeOutputs=Ke,e.serializePayload=ht,e.serializeReferenceUnlockBlock=Ze,e.serializeReturnFeatureBlock=R,e.serializeSenderFeatureBlock=H,e.serializeSigLockedDustAllowanceOutput=Re,e.serializeSignature=tt,e.serializeSignatureUnlockBlock=rt,e.serializeSimpleOutput=He,e.serializeSimpleTokenScheme=Ue,e.serializeTimelockMilestoneIndexFeatureBlock=b,e.serializeTimelockUnixFeatureBlock=D,e.serializeTokenScheme=ke,e.serializeTransactionEssence=Xe,e.serializeTreasuryInput=te,e.serializeTreasuryOutput=be,e.serializeUTXOInput=re,e.serializeUnlockBlock=ut,e.serializeUnlockBlocks=ot,e.setLogger=function(e){zt=e},Object.defineProperty(e,"__esModule",{value:!0})}));